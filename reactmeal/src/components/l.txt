import { Link } from "react-router-dom";
import { TopNav } from '../topNav'
import { SideNav } from '../sideNav'
import { useState } from "react";
import Axios from "axios";

export const Login = () => {
	const [formValue, setFormValue] = useState({
		user: '',
		pass: ''
	})
	
	const handleChange = (event) => {
		let value = event.target.value;
		let name = event.target.name;
		setFormValue((prevState) => {
			return {
				...prevState,
				[name]: value
			}
		}); 
	}

	async function login(e) {
		e.preventDefault();
		console.log("sent");
		await Axios.post('http://localhost:5000/loginUser', {
			user: formValue.user,  
			pass: formValue.pass
		});
	}
	
	async function logout(e) {
		e.preventDefault();
		console.log("sent");
		await Axios.post('http://localhost:5000/logoutUser', {
			user: formValue.user,
		});
	}

	return (
        	<>
            	<TopNav/>
            	<div className="login">
                		<form className="loginForm">
					Login<br/>
                    		Username:
                        	<div>
                        		<input type="text" name="user" onChange={handleChange}/>
                        	</div>
                    		Password:
                        	<div>
                            		<input type="text" name="pass" onChange={handleChange}/>
                        	</div>
					<div>
						<button type="submit" onClick={login}>Login</button>
						<button type="submit" onClick={logout}>Logout</button><br/>
					</div>
					<Link to="/recovery">Forgot Password</Link><br/>
					<Link to="/signup">Create an Account</Link><br/>
					<Link to="/">Continue As Guest</Link><br/>
                		</form>
           		</div>
			<SideNav/>
        	</>
	);
}